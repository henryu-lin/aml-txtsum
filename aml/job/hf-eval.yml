$schema: https://azuremlsdk2.blob.core.windows.net/latest/commandJob.schema.json
experiment_name: hf-eval

code:
    local_path: ../exp

command: >-
    python hf-eval.py \
    --model_name_or_path google/pegasus-xsum \
    --max_source_length 512 \
    --max_target_length 56 \
    --per_device_eval_batch_size 8 \
    --max_predict_samples 128 \
    --predict_with_generate \
    --do_predict \
    --output_dir "./outputs/summaries" \
    --overwrite_output_dir \
    --dataset_dir {inputs.corpus}

environment: azureml:hf-gpu:1
    
inputs:
    corpus:
        data: azureml:hf-reddit-dota:1
        mode: mount

compute:
    target: azureml:gpu-v100-1