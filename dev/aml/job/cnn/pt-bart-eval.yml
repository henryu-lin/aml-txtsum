$schema: https://azuremlschemas.azureedge.net/latest/commandJob.schema.json
experiment_name: cnn
tags:
    model: "bart-large-cnn"
code:
    local_path: ../../src
command: >
    python trainer-wip.py 
    --model_name_or_path "facebook/bart-large-cnn" 
    --dataset_name "cnn" 
    --dataset_path {inputs.corpus} 
    --fp16 True 
    --per_device_eval_batch_size 16 
    --do_predict 
    --predict_with_generate 
    --overwrite_output_dir 
    --output_dir "./outputs" 
    --logging_dir "./logs"
environment: azureml:hf-deepspeed:3
inputs:
    corpus:
        data: azureml:hf-cnn:1
        mode: download
compute:
    target: azureml:gpu-v100-8-lp
    instance_count: 1
distribution:
    type: pytorch
    process_count: 8