{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspaceName": {
      "type": "string",
      "metadata": {
        "description": "Specifies the name of the Azure Machine Learning Workspace which will contain these assets."
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "The location of the Azure Machine Learning Workspace."
      }
    },
    "computeName": {
      "type": "string",
      "metadata": {
        "description": "Specifies the name of the Azure Machine Learning Compute cluster."
      }
    },
    "computeMinNodes": {
      "defaultValue": 0,
      "type": "int",
      "metadata": {
        "description": "The minimum number of nodes to use on the cluster."
      }
    },
    "computeMaxNodes": {
      "defaultValue": 1,
      "type": "int",
      "metadata": {
        "description": " The maximum number of nodes to use on the cluster."
      }
    },
    "computeSize": {
      "defaultValue": "Standard_NC24rs_v3",
      "type": "string",
      "metadata": {
        "description": " The size of agent VMs. More details can be found here: https://aka.ms/azureml-vm-details."
      }
    },
    "computePriority": {
      "defaultValue": "Dedicated",
      "type": "string",
      "metadata": {
        "description": " Virtual Machine priority - Dedicated, LowPriority."
      }
    },
    "computeScaleDownTime": {
      "defaultValue": "300",
      "type": "string",
      "metadata": {
        "description": " Node idle time (seconds) before scaling down amlCompute."
      }
    },
    "dataName": {
      "type": "string",
      "metadata": {
        "description": "Name of data asset."
      }
    },
    "dataVersion": {
      "defaultValue": "1",
      "type": "string"
    },
    "codeName": {
      "type": "string",
      "metadata": {
        "description": "Name of code asset."
      }
    },
    "codeVersion": {
      "defaultValue": "1",
      "type": "string"
    },
    "environmentName": {
      "type": "string",
      "metadata": {
        "description": "Name of environment asset."
      }
    },
    "environmentVersion": {
      "defaultValue": "1",
      "type": "string"
    }
  },
  "variables": {},
  "resources": [
    {
      "type": "Microsoft.MachineLearningServices/workspaces/computes",
      "name": "[concat(parameters('workspaceName'), '/', parameters('computeName'))]",
      "apiVersion": "2021-04-01",
      "location": "[parameters('location')]",
      "dependsOn": [
        "[parameters('workspaceName')]"
      ],
      "properties": {
        "computeType": "AmlCompute",
        "properties": {
          "vmSize": "[parameters('computeSize')]",
          "vmPriority": "[parameters('computePriority')]",
          "scaleSettings": {
            "minNodeCount": "[parameters('computeMinNodes')]",
            "maxNodeCount": "[parameters('computeMaxNodes')]",
            "nodeIdleTimeBeforeScaleDown": "[parameters('computeScaleDownTime')]"
          }
        }
      }
    },
    {
      "name": "[concat(parameters('workspaceName'), '/', parameters('dataName'), '/', parameters('dataVersion'))]",
      "type": "Microsoft.MachineLearningServices/workspaces/data/versions",
      "apiVersion": "2021-03-01-preview",
      "dependsOn": [
        "[parameters('workspaceName')]"
      ],
      "properties": {
        "datasetType": "Simple",
        "path": "string",
        "properties": {
          "path": ""
        }
      }
    },
    {
      "name": "[concat(parameters('workspaceName'), '/', parameters('codeName'), '/', parameters('codeVersion'))]",
      "type": "Microsoft.MachineLearningServices/workspaces/codes/versions",
      "apiVersion": "2021-03-01-preview",
      "dependsOn": [
        "[parameters('workspaceName')]"
      ],
      "properties": {
        "datastoreId": "string",
        "path": "string",
        "properties": {}
      }
    },
    {
      "name": "[concat(parameters('workspaceName'), '/', parameters('environmentName'), '/', parameters('environmentVersion'))]",
      "type": "Microsoft.MachineLearningServices/workspaces/environments/versions",
      "apiVersion": "2021-03-01-preview",
      "dependsOn": [
        "[parameters('workspaceName')]"
      ],
      "properties": {
        "condaFile": "string",
        "docker": {
          "dockerSpecificationType": "Build",
          "context": "string",
          "dockerfile": "string"
        },
        "properties": {
          "httpurl": ""
        }
      }
    }
  ]
}
